import{r as n,v as y,w as S,j as e,S as v,y as o,z as k,T as w,B as E,x as F,N as u,O as R,D as g,Q as A}from"./index-DCgGlQVr.js";import{S as M}from"./star-D0C5l1bW.js";const z=F({name:g().min(1,"Name is required."),rating:A().min(1).max(5),comments:g().min(10,"Please provide at least 10 characters.")});function Y(){const[a,i]=n.useState([]),[h,b]=n.useState(!0),[l,d]=n.useState(null),{register:c,handleSubmit:p,reset:j,formState:{errors:t,isSubmitting:x}}=y({resolver:S(z),defaultValues:{name:"",rating:5,comments:""}}),f=n.useMemo(()=>{if(a.length===0)return 0;const s=a.reduce((r,m)=>r+m.rating,0);return Math.round(s/a.length*10)/10},[a]);n.useEffect(()=>{(async()=>{try{const r=await u();i(r)}catch(r){d(r instanceof Error?r.message:"Unable to load feedback.")}finally{b(!1)}})()},[]);const N=async s=>{d(null);try{await R({name:s.name,rating:s.rating,comments:s.comments});const r=await u();i(r)}catch(r){d(r instanceof Error?r.message:"Unable to submit feedback.")}j()};return e.jsxs("section",{className:"py-16 px-4 sm:px-6 lg:px-8 bg-background",children:[e.jsx(v,{title:"Feedback",description:"Share your Kyrgyz Riders experience and read recent traveler feedback."}),e.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl sm:text-4xl text-foreground mb-4",children:"Share Your Experience"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Tell us about your journey. Your feedback helps future travelers plan their adventures in Kyrgyzstan."}),e.jsxs("form",{onSubmit:p(N),className:"space-y-4 bg-card border border-border rounded-lg p-4 sm:p-6",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"name",children:"Name"}),e.jsx(k,{id:"name",placeholder:"Your name",...c("name")}),t.name&&e.jsx("p",{className:"text-xs text-red-600",children:t.name.message})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"rating",children:"Rating"}),e.jsx("select",{id:"rating",className:"w-full h-10 px-3 rounded-md border border-border bg-card text-sm",...c("rating",{valueAsNumber:!0}),children:[5,4,3,2,1].map(s=>e.jsxs("option",{value:s,children:[s," stars"]},s))}),t.rating&&e.jsx("p",{className:"text-xs text-red-600",children:t.rating.message})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"comments",children:"Comments"}),e.jsx(w,{id:"comments",rows:5,placeholder:"Share what you loved about the tour...",...c("comments")}),t.comments&&e.jsx("p",{className:"text-xs text-red-600",children:t.comments.message})]}),l&&e.jsx("p",{className:"text-sm text-red-600",children:l}),e.jsx(E,{type:"submit",className:"btn-micro bg-primary hover:bg-primary/90 text-primary-foreground",disabled:x,children:x?"Submitting...":"Submit Feedback"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl text-foreground",children:"Recent Feedback"}),e.jsxs("p",{className:"text-muted-foreground",children:["Average rating: ",f||"-"," / 5"]})]}),h?e.jsx("p",{className:"text-muted-foreground",children:"Loading feedback..."}):a.length===0?e.jsx("p",{className:"text-muted-foreground",children:"No feedback yet."}):e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:[...Array(s.rating)].map((r,m)=>e.jsx(M,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"},m))}),e.jsx("p",{className:"text-muted-foreground mb-3",children:s.comments}),s.adminResponse&&e.jsxs("p",{className:"text-sm text-foreground mb-2",children:["Admin response: ",s.adminResponse]}),e.jsx("p",{className:"text-sm text-foreground",children:s.name})]},s.id))})]})]})]})}export{Y as FeedbackPage};
